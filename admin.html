<!DOCTYPE html>
<html>
<head>
  <title>Admin Upload</title>
  <style>
    .img-wrapper { margin:10px; display:inline-block; position:relative; }
    .img-wrapper img { border:1px solid #ccc; }
    .delete-btn { position:absolute; top:0; right:0; background:red; color:white; border:none; cursor:pointer; }
  </style>
</head>
<body>
<h2>Upload Image</h2>
<input type="file" id="fileInput"/>
<button onclick="uploadFiles()">Upload</button>

<h2>Uploaded Images</h2>
<div id="preview" style="display:flex; flex-wrap:wrap;"></div>

<script>
const CLOUD_NAME = "djoqjaxba";          // your Cloudinary cloud name
const UPLOAD_PRESET = "unsigned_upload";  // your unsigned preset

function getStoredImages() {
  return JSON.parse(localStorage.getItem("uploadedImages") || "[]");
}

function saveStoredImages(images) {
  localStorage.setItem("uploadedImages", JSON.stringify(images));
}

// Upload image to Cloudinary
async function uploadFiles() {
  const file = document.getElementById("fileInput").files[0];
  if(!file) return alert("Select a file");

  const url = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`;
  const formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", UPLOAD_PRESET);

  try {
    const res = await fetch(url, { method:"POST", body:formData });
    const data = await res.json();

    const images = getStoredImages();
    images.push({ url: data.secure_url });
    saveStoredImages(images);

    showUploadedImages();
  } catch(err) {
    console.error(err);
    alert("Upload failed");
  }
}

// Display images with delete button
function showUploadedImages() {
  const images = getStoredImages();
  const preview = document.getElementById("preview");

  preview.innerHTML = images.map((img,index)=>`
    <div class="img-wrapper">
      <img src="${img.url}" width="200"/>
      <button class="delete-btn" onclick="deleteImage(${index})">âœ–</button>
    </div>
  `).join('');
}

function deleteImage(index) {
  const images = getStoredImages();
  images.splice(index,1);
  saveStoredImages(images);
  showUploadedImages();
}

// Initial display
showUploadedImages();
</script>
</body>
</html>
